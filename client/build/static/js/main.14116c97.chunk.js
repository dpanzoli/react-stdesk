(this["webpackJsonpreact-stdesk"]=this["webpackJsonpreact-stdesk"]||[]).push([[0],{149:function(e,t,s){},151:function(e,t,s){},156:function(e,t,s){},175:function(e,t,s){},179:function(e,t,s){},180:function(e,t,s){"use strict";s.r(t);var n=s(0),c=s.n(n),a=s(51),i=s.n(a),o=(s(149),s(59)),r=s(60),d=s(52),l=s(73),j=s(68),u=s(25),h=s(61),m=s.n(h),b=(s(113),s(151),s(194)),O=s(5),f=function(e){Object(l.a)(s,e);var t=Object(j.a)(s);function s(e){var n;return Object(o.a)(this,s),(n=t.call(this,e)).state={overdue:!0},n.selectTask=n.selectTask.bind(Object(d.a)(n)),n}return Object(r.a)(s,[{key:"componentDidMount",value:function(){}},{key:"selectTask",value:function(e){e.stopPropagation(),this.props.taskHasChanged(this.props.id)}},{key:"render",value:function(){var e,t,s;return e=this.props.date?Object(O.jsxs)("div",{className:"caldate",children:[Object(O.jsx)("span",{className:"month",children:m()(this.props.date).format("MMM")}),Object(O.jsx)("span",{className:"day",children:m()(this.props.date).format("Do")})]}):Object(O.jsx)("div",{className:"nodate"}),this.props.complete&&(t=Object(O.jsxs)("div",{className:"ui green basic label",children:[Object(O.jsx)("i",{className:"check icon"}),"Compl\xe9t\xe9"]})),this.state.overdue||(s=Object(O.jsxs)("div",{className:"ui red basic label",children:[Object(O.jsx)("i",{className:"exclamation icon"}),"En retard"]})),Object(O.jsxs)("div",{className:"ui  item",onClick:this.selectTask,children:[e,Object(O.jsx)("div",{className:"content",children:Object(O.jsxs)("div",{className:"ui segment ".concat(this.props.selected?"blue raised":""),children:[Object(O.jsx)("h3",{className:"header",children:this.props.titre}),Object(O.jsx)("div",{className:"description",children:Object(O.jsx)("p",{})}),Object(O.jsxs)("div",{className:"extra",children:[Object(O.jsx)("div",{className:"ui tag labels",children:this.props.categories.map((function(e){return Object(O.jsx)("span",{className:"ui label",children:e.lib},e.id)}))}),t,s]}),Object(O.jsx)(b.a,{attached:"bottom",value:2,total:5,indicating:!0})]})})]})}}]),s}(c.a.Component),p=(s(156),function(e){Object(l.a)(s,e);var t=Object(j.a)(s);function s(e){var n;return Object(o.a)(this,s),(n=t.call(this,e)).state={error:null,isLoaded:!1,items:[]},n}return Object(r.a)(s,[{key:"componentDidMount",value:function(){var e=this;fetch("/allTasks").then((function(e){return e.json()})).then((function(t){e.setState({isLoaded:!0,items:t})}),(function(t){e.setState({isLoaded:!0,error:t})}))}},{key:"render",value:function(){var e=this,t=this.state,s=t.error,n=t.isLoaded,c=t.items;return s?Object(O.jsxs)("div",{className:"ui negative message",children:[Object(O.jsx)("div",{className:"header",children:"Chargement des t\xe2ches depuis la base de donn\xe9es"}),Object(O.jsx)("p",{children:"Le serveur a renvoy\xe9 une erreur"})]}):n?Object(O.jsx)("div",{id:"tasklist",className:"ui items",children:Object.entries(c).map((function(t){var s=Object(u.a)(t,2),n=s[0],c=s[1];return Object(O.jsx)(f,{id:n,titre:c.title,date:c.date,categories:c.categories,complete:c.complete,taskHasChanged:e.props.taskHasChanged,selected:e.props.selectedTask===n},n)}))}):Object(O.jsx)("div",{className:"ui active center inline large text loader",children:"Chargement des t\xe2ches"})}}]),s}(c.a.Component)),v=s(128),x=s.n(v),k=s(196),g=s(198),C=s(195),N=s(192),S=s(193),T=s(199),y=s(77);s(175);function D(e){return Object(O.jsx)("div",{className:"ui divided items",children:e.comments.map((function(t){return Object(O.jsx)(M,{commentData:t,requestRefresh:e.requestRefresh},t.id)}))})}function M(e){var t=Object(n.useState)({showControls:!0}),s=Object(u.a)(t,2),c=s[0],a=(s[1],Object(O.jsx)("div",{children:e.commentData.comment}));return e.commentData.is_subtask&&(a=Object(O.jsx)(T.a,{defaultChecked:e.commentData.is_completed,label:e.commentData.comment,onClick:function(t){var s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idComment:e.commentData.id,newChecked:!e.commentData.is_completed})};fetch("/checkComment",s).then((function(e){return e.json()})).then((function(e){console.log("refresh component only")}))}})),Object(O.jsx)("div",{className:"item",children:Object(O.jsxs)("div",{className:"content",children:[a,Object(O.jsxs)("div",{className:"extra",children:["Le ",m()(e.commentData.date).format("Do MMMM YYYY"),"par ",e.commentData.user,Object(O.jsxs)("span",{className:"control ".concat(c.showControls?"shown":""),children:["\xa0\u2014\xa0",Object(O.jsxs)(k.a,{compact:!0,basic:!0,size:"mini",icon:!0,children:[Object(O.jsx)(y.a,{name:"edit"}),"Modifier"]}),Object(O.jsxs)(k.a,{compact:!0,basic:!0,size:"mini",icon:!0,onClick:function(t){console.log(e);var s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({commentId:e.commentData.id})};fetch("/deleteComment",s).then((function(e){return e.json()})).then((function(t){e.requestRefresh()}))},children:[Object(O.jsx)(y.a,{name:"delete"}),"Supprimer"]})]})]})]})})}var w=function(e){var t,s,c=Object(n.useState)(""),a=Object(u.a)(c,2),i=a[0],o=a[1],r=Object(n.useState)(!1),d=Object(u.a)(r,2),l=d[0],j=d[1],h=Object(n.useState)(25),m=Object(u.a)(h,2),f=(m[0],m[1],Object(n.useState)(4)),p=Object(u.a)(f,2),v=p[0],T=(p[1],Object(n.useState)(5)),y=Object(u.a)(T,2),M=y[0],w=(y[1],Object(n.useState)("no")),H=Object(u.a)(w,2),L=H[0],q=H[1],E=Object(n.useState)(""),P=Object(u.a)(E,2),R=P[0],F=P[1],J=Object(n.useState)(!1),Y=Object(u.a)(J,2),z=Y[0],I=Y[1];return Object(n.useEffect)((function(){o([]),q("no"),j(!0),x.a.get("/allComments?idTask=".concat(e.id)).then((function(e){o(e.data),j(!1)})).catch((function(e){return console.log("Erreur : ".concat(e))}))}),[e.id]),M>0&&(t=Object(O.jsx)(b.a,{value:v,total:M,progress:"ratio",indicating:!0})),"no"===L?s=Object(O.jsx)(k.a,{onClick:function(){return q("writing")},children:"Commenter"}):"writing"!==L&&"sending"!==L||(s=Object(O.jsxs)(g.a,{children:[Object(O.jsx)(C.a,{active:"sending"==L,inverted:!0,children:Object(O.jsx)(N.a,{inverted:!0,content:"Envoi"})}),Object(O.jsxs)(S.a,{children:[Object(O.jsx)(S.a.TextArea,{label:"Nouveau commentaire",placeholder:"\xc9crivez ici ...",onChange:function(e,t){F(t.value)}}),Object(O.jsx)(S.a.Checkbox,{label:"Ce commentaire est une sous-t\xe2che",onChange:function(e,t){I(t.checked)}}),Object(O.jsx)(k.a,{onClick:function(){return q("sending")},children:"Enregistrer"})]})]})),Object(n.useEffect)((function(){if("sending"==L){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idTask:e.id,comment:R,isSubtask:z})};fetch("/sendComment",t).then((function(e){return e.json()})).then((function(t){e.requestRefresh()}))}}),[L]),-1===e.id?Object(O.jsx)("div",{}):Object(O.jsxs)("div",{id:"taskdetails",className:"ui piled segment",onClick:function(e){return e.stopPropagation()},children:[Object(O.jsxs)("h4",{children:["D\xe9tails de la t\xe2che ",e.id," "]}),t,l?Object(O.jsx)("div",{className:"ui active center inline loader"}):Object(O.jsx)(D,{comments:i,requestRefresh:e.requestRefresh}),s]})},H=(s(179),function(e){Object(l.a)(s,e);var t=Object(j.a)(s);function s(e){var n;return Object(o.a)(this,s),(n=t.call(this,e)).state={selectedTask:-1},n.taskHasChanged=n.taskHasChanged.bind(Object(d.a)(n)),n.cancelSelection=n.cancelSelection.bind(Object(d.a)(n)),n}return Object(r.a)(s,[{key:"taskHasChanged",value:function(e){this.setState({selectedTask:e})}},{key:"cancelSelection",value:function(){this.setState({selectedTask:-1})}},{key:"render",value:function(){return Object(O.jsxs)(c.a.Fragment,{children:[Object(O.jsx)("h1",{className:"ui header",children:"ST Desk"}),Object(O.jsxs)("div",{className:"ui two column grid",onClick:this.cancelSelection,children:[Object(O.jsx)("div",{className:"column",children:Object(O.jsx)(p,{taskHasChanged:this.taskHasChanged,selectedTask:this.state.selectedTask})}),Object(O.jsx)("div",{className:"column",children:Object(O.jsx)(w,{id:this.state.selectedTask,requestRefresh:this.taskHasChanged})})]})]})}}]),s}(c.a.Component)),L=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,200)).then((function(t){var s=t.getCLS,n=t.getFID,c=t.getFCP,a=t.getLCP,i=t.getTTFB;s(e),n(e),c(e),a(e),i(e)}))};i.a.render(Object(O.jsx)(c.a.StrictMode,{children:Object(O.jsx)(H,{})}),document.getElementById("root")),L()}},[[180,1,2]]]);
//# sourceMappingURL=main.14116c97.chunk.js.map